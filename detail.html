---
layout: null
title: "文档详情"
---

<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>文档详情 - {{ site.title | default: "JQ’s Space" }}</title>
  <meta name="description" content="技术文档详情页">

  <style>
    :root {
      --bg: #050816;
      --bg-card: rgba(15, 23, 42, 0.85);
      --accent: #38bdf8;
      --accent-soft: rgba(56, 189, 248, 0.18);
      --text: #e5e7eb;
      --muted: #9ca3af;
      --border: rgba(148, 163, 184, 0.35);
      --radius-xl: 18px;
      --shadow-soft: 0 22px 45px rgba(15, 23, 42, 0.75);
      --transition: 0.25s ease;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      min-height: 100vh;
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text",
      "PingFang SC", "Helvetica Neue", Arial, "Microsoft YaHei", sans-serif;
      background:
        radial-gradient(circle at top left, rgba(56, 189, 248, .18), transparent 55%),
        radial-gradient(circle at bottom right, rgba(129, 140, 248, .18), transparent 55%),
        var(--bg);
      color: var(--text);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 32px 16px;
    }

    .shell {
      width: 100%;
      max-width: 980px;
      border-radius: 24px;
      background:
        linear-gradient(135deg, rgba(148, 163, 184, 0.25), transparent),
        radial-gradient(circle at top, rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.96));
      padding: 1px;
      box-shadow: var(--shadow-soft);
      position: relative;
      overflow: hidden;
    }

    .shell::before {
      content: "";
      position: absolute;
      inset: -120px;
      opacity: .18;
      background:
        radial-gradient(circle at 20% 0%, rgba(56, 189, 248, .4), transparent 55%),
        radial-gradient(circle at 80% 100%, rgba(147, 51, 234, .42), transparent 55%);
      filter: blur(38px);
      z-index: -1;
    }

    .card {
      border-radius: 24px;
      background: radial-gradient(circle at top, rgba(15, 23, 42, 0.96), rgba(15, 23, 42, 0.98));
      padding: 22px 22px 26px;
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(148, 163, 184, 0.3);
    }

    .nav {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      margin-bottom: 20px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .avatar {
      width: 34px;
      height: 34px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 10%, #e5e7eb, #64748b);
      border: 2px solid rgba(148, 163, 184, 0.65);
      box-shadow: 0 0 0 1px rgba(15, 23, 42, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 16px;
      color: #0f172a;
    }

    .brand-text-main {
      font-size: 18px;
      font-weight: 600;
      letter-spacing: 0.03em;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .brand-sub {
      font-size: 12px;
      color: var(--muted);
    }

    .brand-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: #4ade80;
      box-shadow: 0 0 0 5px rgba(74, 222, 128, 0.18);
    }

    .nav-actions {
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .btn {
      border-radius: 999px;
      padding: 6px 14px;
      font-size: 13px;
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: rgba(15, 23, 42, 0.96);
      color: var(--text);
      cursor: pointer;
      transition: var(--transition);
    }

    .btn:hover {
      border-color: rgba(56, 189, 248, 0.8);
      color: #e0f2fe;
      transform: translateY(-1px);
    }

    .btn-secondary {
      border-color: rgba(148, 163, 184, 0.4);
      color: var(--muted);
    }

    .btn-secondary:hover {
      color: var(--text);
    }

    .doc-header {
      margin-bottom: 16px;
    }

    .doc-title {
      font-size: 22px;
      font-weight: 600;
      margin-bottom: 6px;
    }

    .doc-meta {
      font-size: 12px;
      color: var(--muted);
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    .tag-pill {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(56, 189, 248, 0.6);
      color: #bae6fd;
      background: rgba(8, 47, 73, 0.7);
    }

    .doc-body {
      margin-top: 10px;
      padding: 14px 12px;
      border-radius: var(--radius-xl);
      border: 1px solid var(--border);
      background: radial-gradient(circle at top left, rgba(15, 23, 42, .9), rgba(15, 23, 42, 1));
      font-size: 14px;
      line-height: 1.7;
      white-space: pre-wrap;
      word-break: break-word;
    }

    .doc-empty {
      font-size: 14px;
      color: var(--muted);
      text-align: center;
      padding: 40px 10px;
    }

    @media (max-width: 768px) {
      .card { padding: 18px 16px 22px; }
      .nav { flex-direction: column; align-items: flex-start; gap: 10px; }
      .nav-actions { align-self: stretch; justify-content: flex-end; }
      .doc-title { font-size: 20px; }
    }
  </style>
</head>
<body>
<div class="shell">
  <div class="card">
    <!-- 顶部导航 + 返回 -->
    <header class="nav">
      <div class="brand">
        <div class="avatar">J</div>
        <div>
          <div class="brand-text-main">
            {{ site.title | default: "JQ’s Space" }}
            <span class="brand-dot"></span>
          </div>
          <div class="brand-sub">
            文档详情 · 来自你的 Cloudflare Worker
          </div>
        </div>
      </div>
      <div class="nav-actions">
        <button class="btn btn-secondary" id="btn-back">返回</button>
        <a href="{{ '/' | relative_url }}" class="btn">首页</a>
      </div>
    </header>

    <!-- 内容区 -->
    <section id="doc-container">
      <div class="doc-header">
        <h1 class="doc-title" id="doc-title">加载中…</h1>
        <div class="doc-meta" id="doc-meta"></div>
      </div>

      <div class="doc-body" id="doc-content">
        正在加载文档内容…
      </div>
    </section>
  </div>
</div>

<script>
  // ============ 你在其他地方给 DOCS_API_BASE 赋值 ============
  // window.DOCS_API_BASE = "https://你的 worker 域名";
  const API_BASE = window.DOCS_API_BASE || "https://lingering-resonance-6555.aa1348769445.workers.dev";
  const API_DOCS = API_BASE + "/api/docs";

  function getQueryParam(name) {
    const params = new URLSearchParams(window.location.search);
    return params.get(name);
  }

  function escapeHtml(str) {
    return (str || "").replace(/[&<>"']/g, function (c) {
      return {
        "&": "&amp;",
        "<": "&lt;",
        ">": "&gt;",
        '"': "&quot;",
        "'": "&#39;"
      }[c] || c;
    });
  }

  async function loadDocDetail() {
    const id = getQueryParam("id");
    const titleEl = document.getElementById("doc-title");
    const metaEl = document.getElementById("doc-meta");
    const contentEl = document.getElementById("doc-content");

    if (!id) {
      titleEl.textContent = "缺少文档 ID";
      contentEl.className = "doc-empty";
      contentEl.textContent = "URL 中没有找到 id 参数，无法加载文档。";
      return;
    }

    try {
      const res = await fetch(API_DOCS);
      const data = await res.json();

      if (!data.ok) {
        titleEl.textContent = "加载失败";
        contentEl.className = "doc-empty";
        contentEl.textContent = data.error || "未知错误";
        return;
      }

      const docs = data.items || [];
      const doc = docs.find(d => d.id === id);

      if (!doc) {
        titleEl.textContent = "未找到文档";
        contentEl.className = "doc-empty";
        contentEl.textContent = "根据当前 ID 没有找到对应的文档。";
        return;
      }

      titleEl.textContent = doc.title || "(无标题)";

      // 时间 & 标签
      const parts = [];
      if (doc.createdAt) {
        const d = new Date(doc.createdAt);
        parts.push("创建于 " + d.toISOString().slice(0, 10));
      }
      if (doc.updatedAt && doc.updatedAt !== doc.createdAt) {
        const d2 = new Date(doc.updatedAt);
        parts.push("更新于 " + d2.toISOString().slice(0, 10));
      }

      metaEl.innerHTML = "";
      if (parts.length) {
        const span = document.createElement("span");
        span.textContent = parts.join(" · ");
        metaEl.appendChild(span);
      }

      if (doc.tags && doc.tags.length) {
        doc.tags.forEach(tag => {
          const t = document.createElement("span");
          t.className = "tag-pill";
          t.textContent = tag;
          metaEl.appendChild(t);
        });
      }

      // 文本内容：为了安全，默认走 textContent（纯文本）
      contentEl.className = "doc-body";
      contentEl.textContent = doc.content || "";
    } catch (err) {
      console.error(err);
      titleEl.textContent = "请求异常";
      contentEl.className = "doc-empty";
      contentEl.textContent = "网络或服务异常，请稍后再试。";
    }
  }

  // 返回按钮：优先 history.back，退不了就回首页
  document.getElementById("btn-back").addEventListener("click", () => {
    // 如果有来源并且同域，走 history.back
    if (document.referrer && document.referrer.indexOf(location.host) !== -1) {
      history.back();
    } else {
      // 没有历史记录就跳首页
      window.location.href = "{{ '/' | relative_url }}";
    }
  });

  document.addEventListener("DOMContentLoaded", loadDocDetail);
</script>
</body>
</html>
